<!-- ✅ Centered Modal Background -->
<div
  *ngIf="isModalOpen"
  class="fixed inset-0 z-50 flex items-center justify-center"
>
  <!-- ✅ Modal Content -->
  <div class="bg-white p-6 rounded-xl shadow-2xl max-w-lg w-full">
    <!-- ✅ Modal Header -->
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-extrabold text-black">
        {{ isEditing ? "✏ Edit Product" : "➕ Add Product" }}
      </h2>
      <button
        (click)="closeModal()"
        class="text-red-500 text-2xl hover:text-red-600 transition"
      >
        ✖
      </button>
    </div>

    <!-- ✅ Display Error Messages -->
    <div
      *ngIf="errors.length > 0"
      class="bg-red-100 border-l-4 border-red-600 p-3 mb-4 rounded-lg"
    >
      <h4 class="text-red-700 font-semibold">Please fix the following:</h4>
      <ul class="list-disc list-inside text-red-600">
        <li *ngFor="let error of errors">{{ error }}</li>
      </ul>
    </div>

    <!-- ✅ Product Form -->
    <form
      [formGroup]="productForm"
      (ngSubmit)="saveProduct()"
      class="space-y-5"
    >
      <!-- ✅ Product Name -->
      <div>
        <label class="block font-semibold text-gray-700">Product Name</label>
        <input
          type="text"
          formControlName="productName"
          class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:ring focus:ring-blue-300"
        />
      </div>

      <!-- ✅ SKU -->
      <div>
        <label class="block font-semibold text-gray-700">SKU</label>
        <input
          type="text"
          formControlName="sku"
          class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:ring focus:ring-blue-300"
        />
      </div>

      <!-- ✅ Category Dropdown -->
      <div>
        <label class="block font-semibold text-gray-700">Category</label>
        <select
          formControlName="category"
          class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:ring focus:ring-blue-300"
        >
          <option *ngFor="let cat of categories" [value]="cat">
            {{ cat }}
          </option>
        </select>
      </div>

      <!-- ✅ Price -->
      <div>
        <label class="block font-semibold text-gray-700">Price</label>
        <input
          type="number"
          formControlName="price"
          class="border border-gray-300 rounded-lg px-4 py-2 w-full focus:ring focus:ring-blue-300"
        />
      </div>

      <!-- ✅ Toggles -->
      <div class="grid grid-cols-2 gap-4">
        <!-- ✅ Active Toggle -->
        <div class="flex items-center space-x-2">
          <label class="relative inline-flex items-center cursor-pointer">
            <input
              type="checkbox"
              formControlName="active"
              class="sr-only peer"
            />
            <div
              class="w-12 h-6 bg-gray-300 rounded-full peer-checked:bg-green-600 transition-all relative after:content-[''] after:absolute after:w-5 after:h-5 after:bg-white after:rounded-full after:top-0.5 after:left-1 after:transition-all peer-checked:after:translate-x-5"
            ></div>
          </label>
          <span class="font-semibold text-gray-700">Active</span>
        </div>

        <!-- ✅ Requires Serial Number -->
        <div class="flex items-center space-x-2">
          <label class="relative inline-flex items-center cursor-pointer">
            <input
              type="checkbox"
              formControlName="requiresSerialNumber"
              class="sr-only peer"
            />
            <div
              class="w-12 h-6 bg-gray-300 rounded-full peer-checked:bg-green-600 transition-all relative after:content-[''] after:absolute after:w-5 after:h-5 after:bg-white after:rounded-full after:top-0.5 after:left-1 after:transition-all peer-checked:after:translate-x-5"
            ></div>
          </label>
          <span class="font-semibold text-gray-700"
            >Requires Serial Number</span
          >
        </div>
      </div>

      <!-- ✅ Buttons -->
      <div class="flex justify-end space-x-4 mt-6">
        <button
          (click)="closeModal()"
          type="button"
          class="bg-gray-500 text-white px-5 py-2 rounded-lg hover:bg-gray-700 transition"
        >
          Cancel
        </button>

        <button
          type="submit"
          [disabled]="!validateProductForm()"
          class="px-5 py-2 rounded-lg transition duration-300 font-semibold"
          [ngClass]="
            validateProductForm()
              ? 'bg-green-600 text-white hover:bg-green-700'
              : 'bg-gray-400 text-gray-200 cursor-not-allowed'
          "
        >
          {{ isEditing ? "Update Product" : "Add Product" }}
        </button>
      </div>
    </form>
  </div>
</div>
